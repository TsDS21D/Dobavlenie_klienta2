<!DOCTYPE html>
<!-- 
index.html
–ì–ª–∞–≤–Ω—ã–π HTML —à–∞–±–ª–æ–Ω –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞–º–∏ —Ç–∏–ø–æ–≥—Ä–∞—Ñ–∏–∏.
–í–∫–ª—é—á–∞–µ—Ç –±–∞–∑—É –∫–ª–∏–µ–Ω—Ç–æ–≤, WebSocket –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω.
-->

<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞–º–∏ —Ç–∏–ø–æ–≥—Ä–∞—Ñ–∏–∏</title>
    
    <style>
        /* 
        –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ CSS.
        –û–ø—Ä–µ–¥–µ–ª—è—é—Ç –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ.
        */
        
        /* –°–±—Ä–æ—Å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –æ—Ç—Å—Ç—É–ø–æ–≤ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ border-box –º–æ–¥–µ–ª–∏ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –≤—Å–µ–≥–æ —Ç–µ–ª–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: url(https://www.bukva-a.ru/mg-admin/design/images/bg_textures/42.png);
            min-height: 100vh;
            padding: 2rem;
        }

        /* –ü–∞–Ω–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–≤–µ—Ä—Ö—É —Å–ø—Ä–∞–≤–∞) */
        .user-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: white;
            padding: 10px 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-info {
            font-size: 0.9rem;
        }

        .user-info strong {
            color: #0B8661;
        }

        .user-info div {
            font-size: 0.8rem;
            color: #666;
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã */
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 3rem;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–µ—Ä–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è */
        h1 {
            color: #333;
            margin-bottom: 2rem;
            text-align: center;
            font-size: 2rem;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –±–ª–æ–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è */
        .status {
            text-align: center;
            margin-bottom: 2rem;
            font-size: 0.95rem;
            padding: 0.5rem 1rem;
            border-radius: 10px;
            display: inline-block;
            width: 100%;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è */
        .status.connected {
            background: #c8e6c9;
            color: #2e7d32;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è */
        .status.disconnected {
            background: #ffcdd2;
            color: #c62828;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–µ–∫—Ü–∏–∏ —Ñ–æ—Ä–º—ã –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ */
        .form-section {
            background: #f5f5f5;
            padding: 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
        }

        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ –≤—Ç–æ—Ä–æ–≥–æ —É—Ä–æ–≤–Ω—è –≤ —Å–µ–∫—Ü–∏–∏ —Ñ–æ—Ä–º—ã */
        .form-section h2 {
            color: #333;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }

        /* –ì—Ä—É–ø–ø–∞ –ø–æ–ª–µ–π –≤–≤–æ–¥–∞ –≤ —Ñ–æ—Ä–º–µ */
        .form-group {
            margin-bottom: 1rem;
            display: flex;
            flex-direction: column;
        }

        /* –ü–æ–¥–ø–∏—Å–∏ –∫ –ø–æ–ª—è–º –≤–≤–æ–¥–∞ */
        label {
            color: #555;
            margin-bottom: 0.5rem;
            font-weight: 500;
            font-size: 0.95rem;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–ª–µ–π –≤–≤–æ–¥–∞ –∏ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –æ–±–ª–∞—Å—Ç–µ–π */
        input, textarea, select {
            padding: 0.8rem;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            transition: border-color 0.3s ease;
        }

        /* –°—Ç–∏–ª–∏ –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞ */
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.2);
        }

        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –æ–±–ª–∞—Å—Ç–µ–π */
        textarea {
            resize: vertical;
            min-height: 80px;
        }

        /* –ì—Ä—É–ø–ø–∞ –∫–Ω–æ–ø–æ–∫ –≤ —Ñ–æ—Ä–º–µ */
        .button-group {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        /* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ */
        button {
            padding: 1rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã */
        .btn-submit {
            flex: 1;
            background: #0B8661;
            color: white;
            box-shadow: 0 4px 15px rgba(99, 122, 86, 0.6);
        }

        /* –≠—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É –æ—Ç–ø—Ä–∞–≤–∫–∏ */
        .btn-submit:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(99, 122, 86, 0.6);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–Ω–æ–π –∫–Ω–æ–ø–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ */
        .btn-submit:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –æ—á–∏—Å—Ç–∫–∏ —Ñ–æ—Ä–º—ã */
        .btn-clear {
            flex: 1;
            background: #e0e0e0;
            color: #333;
        }

        /* –≠—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É –æ—á–∏—Å—Ç–∫–∏ */
        .btn-clear:hover {
            background: #bdbdbd;
        }

        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–µ–∫—Ü–∏–∏ —Å –∑–∞–∫–∞–∑–∞–º–∏ */
        .orders-section h2 {
            color: #333;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–ø–∏—Å–∫–∞ –∑–∞–∫–∞–∑–æ–≤ */
        .orders-list {
            list-style: none;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –∑–∞–∫–∞–∑–∞ */
        .order-item {
            background: #f9f9f9;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border-left: 4px solid;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        /* –≠—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –∑–∞–∫–∞–∑ */
        .order-item:hover {
            transform: translateY(-1px); 
            box-shadow: 0 3px 10px rgba(99, 122, 86, 0.6); 
        }

        /* –¶–≤–µ—Ç–∞ –≥—Ä–∞–Ω–∏—Ü—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞ */
        .order-item.status-accepted {
            border-left-color: #2196F3; /* –°–∏–Ω–∏–π –¥–ª—è "–ü—Ä–∏–Ω—è—Ç" */
        }
        
        .order-item.status-in_progress {
            border-left-color: #FF9800; /* –û—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è "–í —Ä–∞–±–æ—Ç–µ" */
        }
        
        .order-item.status-ready {
            border-left-color: #4CAF50; /* –ó–µ–ª–µ–Ω—ã–π –¥–ª—è "–ì–æ—Ç–æ–≤" */
        }
        
        .order-item.status-completed {
            border-left-color: #9E9E9E; /* –°–µ—Ä—ã–π –¥–ª—è "–í—ã–¥–∞–Ω" */
        }

        /* –®–∞–ø–∫–∞ –∑–∞–∫–∞–∑–∞ (–Ω–æ–º–µ—Ä –∏ —á–∞—Å—ã) */
        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        /* –ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞ */
        .order-number {
            color: #0B8661;
            font-weight: bold;
            font-size: 1.2rem;
        }

        /* –ë–ª–æ–∫ —Å –æ—Å—Ç–∞–≤—à–∏–º–∏—Å—è —Ä–∞–±–æ—á–∏–º–∏ —á–∞—Å–∞–º–∏ */
        .order-hours {
            background: #0B8661;
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: bold;
        }

        /* –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –º–∞–ª–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —á–∞—Å–æ–≤ */
        .order-hours.warning {
            background: #ff9800;
        }

        /* –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —á–∞—Å–æ–≤ */
        .order-hours.critical {
            background: #f44336;
        }

        /* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∏–µ–Ω—Ç–µ */
        .client-info {
            background: #f0f7ff;
            padding: 0.8rem;
            border-radius: 8px;
            margin: 0.5rem 0;
            border-left: 3px solid #2196F3;
        }

        .client-info-item {
            display: flex;
            margin-bottom: 0.3rem;
            font-size: 0.9rem;
        }

        .client-info-label {
            font-weight: 600;
            min-width: 80px;
            color: #555;
        }

        .client-info-value {
            color: #333;
        }

        .client-edo-badge {
            display: inline-block;
            background: #FF9800;
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-left: 0.5rem;
        }

        /* –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ */
        .description {
            color: #666;
            margin-bottom: 0.5rem;
            line-height: 1.5;
            word-wrap: break-word;
        }

        /* –ë–ª–æ–∫ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∑–∞–∫–∞–∑–µ */
        .order-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-top: 0.8rem;
            font-size: 0.9rem;
            color: #555;
            margin-bottom: 1rem;
        }

        /* –û—Ç–¥–µ–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –¥–µ—Ç–∞–ª–µ–π */
        .detail-item {
            display: flex;
            align-items: center;
        }

        /* –ú–µ—Ç–∫–∞ –¥–ª—è –¥–µ—Ç–∞–ª–µ–π */
        .detail-label {
            font-weight: 600;
            margin-right: 0.5rem;
        }

        /* –ë–ª–æ–∫ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º –∑–∞–∫–∞–∑–∞ */
        .order-status {
            margin: 0.5rem 0;
            font-size: 0.9rem;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ */
        .status-select {
            padding: 0.5rem;
            border-radius: 6px;
            border: 1px solid #ddd;
            background: white;
            font-size: 0.9rem;
            cursor: pointer;
            transition: border-color 0.3s;
        }

        /* –≠—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ –Ω–∞ –≤—ã–ø–∞–¥–∞—é—â–µ–º —Å–ø–∏—Å–∫–µ */
        .status-select:focus {
            outline: none;
            border-color: #0B8661;
        }

        /* –ë–ª–æ–∫ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –¥–µ–π—Å—Ç–≤–∏–π */
        .order-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        /* –ö–Ω–æ–ø–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è */
        .btn-edit {
            flex: 1;
            padding: 0.6rem;
            background: #5fb89d;
            color: white;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        /* –≠—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è */
        .btn-edit:hover {
            background: #0B8661;
            transform: translateY(-2px);
        }

        /* –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è */
        .btn-delete {
            flex: 1;
            padding: 0.6rem;
            background: #cf6b66;
            color: white;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        /* –≠—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É —É–¥–∞–ª–µ–Ω–∏—è */
        .btn-delete:hover {
            background: #b3080b;
            transform: translateY(-2px);
        }

        /* –°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∑–∞–∫–∞–∑–æ–≤ */
        .empty-message {
            text-align: center;
            color: #999;
            padding: 2rem;
            font-style: italic;
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }

        /* –ö–ª–∞—Å—Å –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ */
        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ */
        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ */
        .modal-content h2 {
            color: #333;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }

        /* –ö–Ω–æ–ø–∫–∏ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ */
        .modal-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        /* –ö–Ω–æ–ø–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ */
        .btn-modal-save {
            flex: 1;
            padding: 1rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        /* –≠—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è */
        .btn-modal-save:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        /* –ö–Ω–æ–ø–∫–∞ –æ—Ç–º–µ–Ω—ã –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ */
        .btn-modal-cancel {
            flex: 1;
            padding: 1rem;
            background: #e0e0e0;
            color: #333;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        /* –≠—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É –æ—Ç–º–µ–Ω—ã */
        .btn-modal-cancel:hover {
            background: #bdbdbd;
        }

        /* –ö–Ω–æ–ø–∫–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ */
        .sort-buttons {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ */
        .btn-sort {
            padding: 0.6rem 1rem;
            background: #F9F9F9;
            color: #0B8661;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        /* –≠—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ */
        .btn-sort:hover {
            background: #E9ECEB;
            transform: translateY(-2px);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–π –∫–Ω–æ–ø–∫–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ */
        .btn-sort.active {
            background: #0B8661;
            color: white;
            box-shadow: 0 4px 12px rgba(118, 75, 162, 0.4);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ */
        #client-select option[data-uses-edo="true"] {
            font-weight: bold;
            color: #0B8661;
        }

        #client-select option[data-uses-edo="true"]::after {
            content: " [–≠–î–û]";
            color: #FF9800;
            font-weight: normal;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞ */
        #add-client-btn {
            background: #2196F3;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0.8rem 1.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        #add-client-btn:hover {
            background: #1976D2;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.4);
        }

        /* –°–µ–∫—Ü–∏—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ */
        .completed-orders-section {
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 2px solid #eee;
        }

        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–µ–∫—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ */
        .completed-orders-section h2 {
            color: #666;
            font-size: 1.3rem;
            margin-bottom: 1rem;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ */
        .completed-order-item {
            background: #f0f0f0;
            padding: 1rem;
            margin-bottom: 0.8rem;
            border-left: 4px solid #9E9E9E;
            border-radius: 6px;
            opacity: 0.8;
        }

        /* –ú–æ–±–∏–ª—å–Ω—ã–π –¥–∏–∑–∞–π–Ω (—à–∏—Ä–∏–Ω–∞ —ç–∫—Ä–∞–Ω–∞ –¥–æ 768px) */
        @media (max-width: 768px) {
            body {
                padding: 1rem;
            }

            .container {
                padding: 1.5rem;
                border-radius: 15px;
                max-width: 100%;
            }

            h1 {
                font-size: 1.8rem;
                margin-bottom: 1rem;
            }

            .form-section {
                padding: 1.5rem;
                margin-bottom: 1.5rem;
            }

            .form-section h2 {
                font-size: 1.2rem;
                margin-bottom: 1rem;
            }

            .form-group {
                margin-bottom: 0.8rem;
            }

            label {
                font-size: 0.9rem;
                margin-bottom: 0.3rem;
            }

            input, textarea, select {
                padding: 0.6rem;
                font-size: 1rem;
            }

            textarea {
                min-height: 60px;
            }

            .button-group {
                flex-direction: column;
                gap: 0.5rem;
            }

            button {
                padding: 0.8rem;
                font-size: 0.95rem;
            }

            .orders-section h2 {
                font-size: 1.2rem;
                margin-bottom: 1rem;
            }

            .sort-buttons {
                flex-wrap: wrap;
                gap: 0.4rem;
            }

            .btn-sort {
                flex: 1 1 45%;
                min-width: 45%;
                padding: 0.5rem 0.8rem;
                font-size: 0.85rem;
            }

            .order-item {
                padding: 1rem;
                margin-bottom: 0.8rem;
            }

            .order-header {
                flex-wrap: wrap;
                gap: 0.5rem;
            }

            .order-number {
                font-size: 1rem;
            }

            .order-hours {
                font-size: 0.8rem;
                padding: 0.2rem 0.6rem;
            }

            .client-info-item {
                flex-direction: column;
            }

            .client-info-label {
                min-width: auto;
                margin-bottom: 0.2rem;
            }

            .description {
                font-size: 0.9rem;
            }

            .order-details {
                grid-template-columns: 1fr;
                gap: 0.5rem;
                font-size: 0.85rem;
                margin-bottom: 0.8rem;
            }

            .detail-item {
                flex-wrap: wrap;
            }

            .order-actions {
                flex-direction: column;
                gap: 0.4rem;
            }

            .btn-edit, .btn-delete {
                padding: 0.5rem;
                font-size: 0.85rem;
            }

            .modal-content {
                padding: 1.5rem;
                width: 95%;
                max-width: 95%;
            }

            .modal-content h2 {
                font-size: 1.2rem;
                margin-bottom: 1rem;
            }

            .modal-buttons {
                flex-direction: column;
                gap: 0.5rem;
            }

            .btn-modal-save, .btn-modal-cancel {
                padding: 0.8rem;
                font-size: 0.95rem;
            }

            .user-panel {
                position: relative;
                top: auto;
                right: auto;
                margin-bottom: 1rem;
                justify-content: space-between;
            }
        }

        /* –ú–∞–ª–µ–Ω—å–∫–∏–µ –º–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (—à–∏—Ä–∏–Ω–∞ –¥–æ 480px) */
        @media (max-width: 480px) {
            body {
                padding: 0.5rem;
            }

            .container {
                padding: 1rem;
                border-radius: 12px;
            }

            h1 {
                font-size: 1.5rem;
                margin-bottom: 0.8rem;
            }

            .status {
                font-size: 0.9rem;
                padding: 0.4rem 0.8rem;
            }

            .form-section {
                padding: 1rem;
                margin-bottom: 1rem;
            }

            .form-section h2 {
                font-size: 1.1rem;
                margin-bottom: 0.8rem;
            }

            .form-group {
                margin-bottom: 0.6rem;
            }

            label {
                font-size: 0.85rem;
            }

            input, textarea, select {
                padding: 0.5rem;
                font-size: 16px;
            }

            textarea {
                min-height: 50px;
            }

            .button-group {
                flex-direction: column;
                gap: 0.3rem;
            }

            button {
                padding: 0.7rem;
                font-size: 0.9rem;
            }

            .orders-section h2 {
                font-size: 1.1rem;
            }

            .sort-buttons {
                gap: 0.3rem;
            }

            .btn-sort {
                flex: 1 1 40%;
                min-width: 40%;
                padding: 0.4rem 0.6rem;
                font-size: 0.8rem;
            }

            .order-item {
                padding: 0.8rem;
                margin-bottom: 0.6rem;
                border-left-width: 3px;
            }

            .order-header {
                gap: 0.3rem;
            }

            .order-number {
                font-size: 0.95rem;
            }

            .order-hours {
                font-size: 0.75rem;
                padding: 0.2rem 0.5rem;
            }

            .client-info {
                padding: 0.6rem;
            }

            .client-info-item {
                font-size: 0.8rem;
            }

            .description {
                font-size: 0.85rem;
                margin-bottom: 0.3rem;
            }

            .order-details {
                grid-template-columns: 1fr;
                gap: 0.3rem;
                font-size: 0.8rem;
                margin-bottom: 0.6rem;
            }

            .detail-label {
                display: inline;
                font-weight: 600;
                margin-right: 0.3rem;
            }

            .order-actions {
                flex-direction: column;
                gap: 0.3rem;
            }

            .btn-edit, .btn-delete {
                padding: 0.4rem;
                font-size: 0.8rem;
            }

            .modal-content {
                padding: 1rem;
                width: 95%;
                max-width: 95%;
            }

            .modal-content h2 {
                font-size: 1.1rem;
                margin-bottom: 0.8rem;
            }

            .modal-buttons {
                flex-direction: column;
                gap: 0.3rem;
            }

            .btn-modal-save, .btn-modal-cancel {
                padding: 0.7rem;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <!-- –ü–∞–Ω–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
    <div class="user-panel">
        <div class="user-info">
            <strong>{{ user.username }}</strong>
            <div>{{ user.email|default:"–¢–∏–ø–æ–≥—Ä–∞—Ñ–∏—è –ë—É–∫–≤–∞ –ê" }}</div>
        </div>
        <form action="{% url 'logout' %}" method="post" style="margin: 0;">
            {% csrf_token %}
            <button type="submit" style="background: #f44336; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: 600; transition: background 0.3s;">
                –í—ã–π—Ç–∏
            </button>
        </form>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
    <div class="container">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –ª–æ–≥–æ—Ç–∏–ø–æ–º -->
        <h1>
            <img src="https://www.bukva-a.ru/uploads/logo/logo300.png" 
                alt="–¢–∏–ø–æ–≥—Ä–∞—Ñ–∏—è &quot;–ë—É–∫–≤–∞ –ê&quot;" 
                title="–¢–∏–ø–æ–≥—Ä–∞—Ñ–∏—è &quot;–ë—É–∫–≤–∞ –ê&quot;"
                width="150">
            –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞–º–∏
        </h1>
        
        <!-- –ë–ª–æ–∫ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è WebSocket -->
        <div id="status" class="status disconnected">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</div>

        <!-- –°–µ–∫—Ü–∏—è —Ñ–æ—Ä–º—ã –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∑–∞–∫–∞–∑–∞ -->
        <div class="form-section">
            <h2>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑</h2>
            
            <!-- –ü–æ–ª–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ –∫–ª–∏–µ–Ω—Ç–∞ -->
            <div class="form-group">
                <label for="client-select">–ö–ª–∏–µ–Ω—Ç:</label>
                <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                    <select id="client-select" class="form-control" style="flex: 1;">
                        <option value="">-- –ó–∞–≥—Ä—É–∑–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤... --</option>
                    </select>
                    <button type="button" id="add-client-btn" class="btn-edit" style="width: auto; padding: 0.8rem 1.5rem;">
                        + –î–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞
                    </button>
                </div>
                <div class="help-text" style="font-size: 0.85rem; color: #666; margin-top: 5px;">
                    –í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∏–µ–Ω—Ç–∞ –∏–∑ –±–∞–∑—ã –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤–æ–≥–æ
                </div>
            </div>

            <!-- –ü–æ–ª–µ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞ –∫–ª–∏–µ–Ω—Ç–∞ (—Å–∫—Ä—ã—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
            <div class="form-group" id="manual-client-group" style="display: none;">
                <label for="customer-name">–ò–ª–∏ –≤–≤–µ–¥–∏—Ç–µ –∏–º—è –∫–ª–∏–µ–Ω—Ç–∞ –≤—Ä—É—á–Ω—É—é:</label>
                <input type="text" id="customer-name" class="form-control" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∏ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ">
            </div>

            <!-- –ü–æ–ª–µ –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞ -->
            <div class="form-group">
                <label for="description">–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞:</label>
                <textarea id="description" placeholder="–û–ø–∏—à–∏—Ç–µ —á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤ —ç—Ç–æ–º –∑–∞–∫–∞–∑–µ..." required></textarea>
            </div>

            <!-- –ü–æ–ª–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ -->
            <div class="form-group">
                <label for="ready-datetime">–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:</label>
                <input type="datetime-local" id="ready-datetime" required>
            </div>

            <!-- –ì—Ä—É–ø–ø–∞ –∫–Ω–æ–ø–æ–∫ —Ñ–æ—Ä–º—ã -->
            <div class="button-group">
                <button class="btn-submit" id="submit-btn">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑</button>
                <button type="button" class="btn-clear" id="clear-btn">–û—á–∏—Å—Ç–∏—Ç—å</button>
            </div>
        </div>

        <!-- –°–µ–∫—Ü–∏—è —Å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –∑–∞–∫–∞–∑–∞–º–∏ -->
        <div class="orders-section">
            <h2>–ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–∫–∞–∑—ã</h2>
            
            <!-- –ö–Ω–æ–ø–∫–∏ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ -->
            <div class="sort-buttons">
                <button class="btn-sort" id="sort-by-number">üìä –ü–æ –Ω–æ–º–µ—Ä—É</button>
                <button class="btn-sort active" id="sort-by-deadline">‚è∞ –ü–æ –¥–µ–¥–ª–∞–π–Ω—É</button>
            </div>
            
            <!-- –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ -->
            <ul class="orders-list" id="active-orders-list">
                <li class="empty-message">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤</li>
            </ul>
        </div>

        <!-- –°–µ–∫—Ü–∏—è —Å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏ –∑–∞–∫–∞–∑–∞–º–∏ -->
        <div class="orders-section completed-orders-section">
            <h2>–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã</h2>
            
            <!-- –°–ø–∏—Å–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ -->
            <ul class="orders-list" id="completed-orders-list">
                <li class="empty-message">–ù–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤</li>
            </ul>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞ -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–∫–∞–∑</h2>
            
            <!-- –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ -->
            <div class="form-group">
                <label for="edit-customer-name">–ö–ª–∏–µ–Ω—Ç:</label>
                <input type="text" id="edit-customer-name" required>
            </div>

            <div class="form-group">
                <label for="edit-description">–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞:</label>
                <textarea id="edit-description" required></textarea>
            </div>

            <div class="form-group">
                <label for="edit-ready-datetime">–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:</label>
                <input type="datetime-local" id="edit-ready-datetime" required>
            </div>

            <div class="modal-buttons">
                <button class="btn-modal-save" id="save-edit-btn">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button class="btn-modal-cancel" id="cancel-edit-btn">‚ùå –û—Ç–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞ -->
    <div id="addClientModal" class="modal">
        <div class="modal-content">
            <h2>üìã –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞</h2>
            
            <div class="form-group">
                <label for="new-client-name">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞*:</label>
                <input type="text" id="new-client-name" class="form-control" required>
            </div>
            
            <div class="form-group">
                <label for="new-client-phone">–¢–µ–ª–µ—Ñ–æ–Ω:</label>
                <input type="tel" id="new-client-phone" class="form-control" placeholder="+7 (999) 123-45-67">
            </div>
            
            <div class="form-group">
                <label for="new-client-email">Email:</label>
                <input type="email" id="new-client-email" class="form-control" placeholder="email@example.com">
            </div>
            
            <div class="form-group" style="display: flex; align-items: center; margin: 1rem 0;">
                <input type="checkbox" id="new-client-edo" style="margin-right: 10px;">
                <label for="new-client-edo" style="margin: 0;">–†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ –≠–î–û</label>
            </div>
            
            <div class="form-group">
                <label for="new-client-notes">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</label>
                <textarea id="new-client-notes" class="form-control" rows="3" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–≤–µ–¥–µ–Ω–∏—è –æ –∫–ª–∏–µ–Ω—Ç–µ"></textarea>
            </div>
            
            <div class="modal-buttons">
                <button class="btn-modal-save" id="save-client-btn">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞</button>
                <button class="btn-modal-cancel" id="cancel-client-btn">‚ùå –û—Ç–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- JavaScript –∫–æ–¥ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
    <script>
        // ===== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï =====
        
        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã - —Å—Å—ã–ª–∫–∏ –Ω–∞ HTML —ç–ª–µ–º–µ–Ω—Ç—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        const clientSelect = document.getElementById('client-select');
        const addClientBtn = document.getElementById('add-client-btn');
        const customerNameInput = document.getElementById('customer-name');
        const manualClientGroup = document.getElementById('manual-client-group');
        const descriptionInput = document.getElementById('description');
        const readyDatetimeInput = document.getElementById('ready-datetime');
        const submitBtn = document.getElementById('submit-btn');
        const clearBtn = document.getElementById('clear-btn');
        
        // –°–ø–∏—Å–∫–∏ –∑–∞–∫–∞–∑–æ–≤
        const activeOrdersList = document.getElementById('active-orders-list');
        const completedOrdersList = document.getElementById('completed-orders-list');
        
        // –≠–ª–µ–º–µ–Ω—Ç —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
        const statusElement = document.getElementById('status');
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        const editModal = document.getElementById('editModal');
        const editCustomerNameInput = document.getElementById('edit-customer-name');
        const editDescriptionInput = document.getElementById('edit-description');
        const editReadyDatetimeInput = document.getElementById('edit-ready-datetime');
        const saveEditBtn = document.getElementById('save-edit-btn');
        const cancelEditBtn = document.getElementById('cancel-edit-btn');
        
        const addClientModal = document.getElementById('addClientModal');
        const saveClientBtn = document.getElementById('save-client-btn');
        const cancelClientBtn = document.getElementById('cancel-client-btn');

        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º URL –¥–ª—è WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
        const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
        const wsUrl = `${protocol}//${window.location.host}/ws/order`;

        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        let socket;
        let reconnectInterval;
        let editingOrderNumber = null;
        let currentActiveOrders = [];
        let currentCompletedOrders = [];
        let currentClients = [];
        let sortBy = 'deadline';
        let sortDirection = 1;

        // ===== WEB SOCKET –§–£–ù–ö–¶–ò–ò =====

        /**
         * –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å WebSocket —Å–µ—Ä–≤–µ—Ä–æ–º
         */
        function connect() {
            console.log('–ü–æ–ø—ã—Ç–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ WebSocket:', wsUrl);
            
            socket = new WebSocket(wsUrl);

            socket.onopen = function(e) {
                console.log('‚úÖ WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω —É—Å–ø–µ—à–Ω–æ');
                
                statusElement.textContent = '‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ';
                statusElement.className = 'status connected';
                
                if (reconnectInterval) {
                    clearInterval(reconnectInterval);
                    reconnectInterval = null;
                }
            };

            socket.onmessage = function(event) {
                console.log('–ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞:', event.data);
                
                const data = JSON.parse(event.data);
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤
                if (data.type === 'initial_load' || data.type === 'order_update') {
                    updateOrdersLists(data.active_orders, data.completed_orders);
                    
                    // –ï—Å–ª–∏ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ –µ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç—ã, –æ–±–Ω–æ–≤–ª—è–µ–º –∏—Ö —Å–ø–∏—Å–æ–∫
                    if (data.clients) {
                        updateClientsList(data.clients);
                    }
                }
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤
                if (data.type === 'clients_update') {
                    updateClientsList(data.clients);
                }
            };

            socket.onclose = function(event) {
                console.log('‚ùå WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–æ');
                
                statusElement.textContent = '‚è≥ –ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...';
                statusElement.className = 'status disconnected';

                if (!reconnectInterval) {
                    reconnectInterval = setInterval(() => {
                        console.log('–ü–æ–ø—ã—Ç–∫–∞ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...');
                        connect();
                    }, 3000);
                }
            };

            socket.onerror = function(error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ WebSocket:', error);
            };
        }

        // ===== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –†–ê–ë–û–¢–´ –° –ö–õ–ò–ï–ù–¢–ê–ú–ò =====

        /**
         * –û–±–Ω–æ–≤–ª—è–µ—Ç –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤
         * @param {Array} clients - –º–∞—Å—Å–∏–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤
         */
        function updateClientsList(clients) {
            console.log('–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤:', clients);
            
            currentClients = clients;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–µ–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
            const selectedValue = clientSelect.value;
            
            // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫
            clientSelect.innerHTML = '<option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∏–µ–Ω—Ç–∞ --</option>';
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ —Å–ø–∏—Å–æ–∫
            clients.forEach(client => {
                const option = document.createElement('option');
                option.value = client.id;
                option.textContent = `${client.name}${client.uses_edo ? ' [–≠–î–û]' : ''}`;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ data-–∞—Ç—Ä–∏–±—É—Ç—ã
                option.dataset.phone = client.phone;
                option.dataset.email = client.email;
                option.dataset.usesEdo = client.uses_edo;
                
                clientSelect.appendChild(option);
            });
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω–æ –±—ã–ª–æ
            if (selectedValue) {
                clientSelect.value = selectedValue;
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–ø—Ü–∏—é –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞
            const manualOption = document.createElement('option');
            manualOption.value = 'manual';
            manualOption.textContent = '-- –í–≤–µ—Å—Ç–∏ –≤—Ä—É—á–Ω—É—é --';
            clientSelect.appendChild(manualOption);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–ª—è —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞
            toggleManualClientInput();
        }

        /**
         * –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç/—Å–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–ª–µ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞ –∫–ª–∏–µ–Ω—Ç–∞
         */
        function toggleManualClientInput() {
            if (clientSelect.value === 'manual') {
                manualClientGroup.style.display = 'block';
                customerNameInput.focus();
            } else {
                manualClientGroup.style.display = 'none';
                customerNameInput.value = '';
            }
        }

        /**
         * –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞
         */
        function openAddClientModal() {
            // –û—á–∏—â–∞–µ–º –ø–æ–ª—è —Ñ–æ—Ä–º—ã
            document.getElementById('new-client-name').value = '';
            document.getElementById('new-client-phone').value = '';
            document.getElementById('new-client-email').value = '';
            document.getElementById('new-client-edo').checked = false;
            document.getElementById('new-client-notes').value = '';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            addClientModal.classList.add('show');
        }

        /**
         * –ó–∞–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞
         */
        function closeAddClientModal() {
            addClientModal.classList.remove('show');
        }

        /**
         * –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
         */
        function saveNewClient() {
            const name = document.getElementById('new-client-name').value.trim();
            const phone = document.getElementById('new-client-phone').value.trim();
            const email = document.getElementById('new-client-email').value.trim();
            const usesEdo = document.getElementById('new-client-edo').checked;
            const notes = document.getElementById('new-client-notes').value.trim();
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è
            if (!name) {
                alert('‚ö†Ô∏è –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞!');
                return;
            }
            
            if (socket.readyState !== WebSocket.OPEN) {
                alert('‚ùå –ù–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º.');
                return;
            }
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
            socket.send(JSON.stringify({
                action: 'add_client',
                client_data: {
                    name: name,
                    phone: phone,
                    email: email,
                    uses_edo: usesEdo,
                    notes: notes
                }
            }));
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            closeAddClientModal();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            alert(`‚úÖ –ö–ª–∏–µ–Ω—Ç "${name}" –¥–æ–±–∞–≤–ª–µ–Ω –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö!`);
        }

        /**
         * –ü–æ–ª—É—á–∞–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ –¥–ª—è —Ñ–æ—Ä–º—ã –∑–∞–∫–∞–∑–∞
         * @returns {Object} –æ–±—ä–µ–∫—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ –∫–ª–∏–µ–Ω—Ç–∞ –∏–ª–∏ null
         */
        function getSelectedClient() {
            const selectedOption = clientSelect.options[clientSelect.selectedIndex];
            
            if (clientSelect.value && clientSelect.value !== 'manual') {
                return {
                    id: clientSelect.value,
                    name: selectedOption.textContent.replace(' [–≠–î–û]', ''),
                    phone: selectedOption.dataset.phone,
                    email: selectedOption.dataset.email,
                    uses_edo: selectedOption.dataset.usesEdo === 'true'
                };
            } else if (clientSelect.value === 'manual' && customerNameInput.value.trim()) {
                return {
                    id: null,
                    name: customerNameInput.value.trim(),
                    phone: '',
                    email: '',
                    uses_edo: false
                };
            }
            
            return null;
        }

        // ===== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –†–ê–ë–û–¢–´ –° –ó–ê–ö–ê–ó–ê–ú–ò =====

        /**
         * –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç CSS –∫–ª–∞—Å—Å –¥–ª—è –±–ª–æ–∫–∞ —Å —á–∞—Å–∞–º–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —á–∞—Å–æ–≤
         * @param {number} hours - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è —Ä–∞–±–æ—á–∏—Ö —á–∞—Å–æ–≤
         * @returns {string} CSS –∫–ª–∞—Å—Å
         */
        function getHoursClassName(hours) {
            if (hours <= 1) return 'order-hours critical';
            if (hours <= 3) return 'order-hours warning';
            return 'order-hours';
        }

        /**
         * –û–±–Ω–æ–≤–ª—è–µ—Ç —Å–ø–∏—Å–∫–∏ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
         * @param {Array} activeOrders - –º–∞—Å—Å–∏–≤ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤
         * @param {Array} completedOrders - –º–∞—Å—Å–∏–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤
         */
        function updateOrdersLists(activeOrders, completedOrders) {
            console.log('–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤ –∑–∞–∫–∞–∑–æ–≤:', {activeOrders, completedOrders});
            
            currentActiveOrders = activeOrders;
            currentCompletedOrders = completedOrders;
            
            renderActiveOrders();
            renderCompletedOrders();
        }

        /**
         * –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–∫–∞–∑—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
         */
        function renderActiveOrders() {
            activeOrdersList.innerHTML = '';

            if (currentActiveOrders.length === 0) {
                activeOrdersList.innerHTML = '<li class="empty-message">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤</li>';
                return;
            }

            let sortedOrders = [...currentActiveOrders];
            
            if (sortBy === 'number') {
                sortedOrders.sort((a, b) => {
                    return (parseInt(a.order_number) - parseInt(b.order_number)) * sortDirection;
                });
            } else if (sortBy === 'deadline') {
                sortedOrders.sort((a, b) => {
                    const [dateA, timeA] = a.ready_datetime.split(' ');
                    const [dateB, timeB] = b.ready_datetime.split(' ');
                    const [dayA, monthA, yearA] = dateA.split('.');
                    const [dayB, monthB, yearB] = dateB.split('.');
                    
                    const dateObjA = new Date(`${yearA}-${monthA}-${dayA}T${timeA}`);
                    const dateObjB = new Date(`${yearB}-${monthB}-${dayB}T${timeB}`);
                    
                    return (dateObjA - dateObjB) * sortDirection;
                });
            }

            sortedOrders.forEach((order) => {
                const li = document.createElement('li');
                li.className = `order-item status-${order.status}`;
                
                const hours = order.working_hours_remaining;
                const hoursClass = getHoursClassName(hours);

                li.innerHTML = `
                    <div class="order-header">
                        <div class="order-number">‚Ññ${order.order_number}</div>
                        <div class="${hoursClass}">‚è±Ô∏è ${hours}—á</div>
                    </div>
                `;

                // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–ª–∏–µ–Ω—Ç–µ
                if (order.client) {
                    li.innerHTML += `
                        <div class="client-info">
                            <div class="client-info-item">
                                <span class="client-info-label">üë§ –ö–ª–∏–µ–Ω—Ç:</span>
                                <span class="client-info-value">
                                    ${order.client.name}
                                    ${order.client.uses_edo ? '<span class="client-edo-badge">–≠–î–û</span>' : ''}
                                </span>
                            </div>
                            ${order.client.phone ? `<div class="client-info-item">
                                <span class="client-info-label">üìû –¢–µ–ª–µ—Ñ–æ–Ω:</span>
                                <span class="client-info-value">${order.client.phone}</span>
                            </div>` : ''}
                            ${order.client.email ? `<div class="client-info-item">
                                <span class="client-info-label">‚úâÔ∏è Email:</span>
                                <span class="client-info-value">${order.client.email}</span>
                            </div>` : ''}
                        </div>
                    `;
                } else {
                    li.innerHTML += `<div class="customer-name"><h2>üë§ ${order.customer_name}<h2></div>`;
                }

                li.innerHTML += `
                    <div class="description">üìù ${order.description}</div>
                    
                    <div class="order-details">
                        <div class="detail-item">
                            <span class="detail-label">üìÖ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å:</span>
                            <span>${order.ready_datetime}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">üïê –î–æ–±–∞–≤–ª–µ–Ω:</span>
                            <span>${order.created_at}</span>
                        </div>
                    </div>
                    
                    <div class="order-status">
                        <span class="detail-label">üìä –°—Ç–∞—Ç—É—Å:</span>
                        <select class="status-select" data-order-number="${order.order_number}">
                            <option value="accepted" ${order.status === 'accepted' ? 'selected' : ''}>–ü—Ä–∏–Ω—è—Ç</option>
                            <option value="in_progress" ${order.status === 'in_progress' ? 'selected' : ''}>–í —Ä–∞–±–æ—Ç–µ</option>
                            <option value="ready" ${order.status === 'ready' ? 'selected' : ''}>–ì–æ—Ç–æ–≤</option>
                            <option value="completed" ${order.status === 'completed' ? 'selected' : ''}>–í—ã–¥–∞–Ω</option>
                        </select>
                        <span class="status-display">(${order.status_display})</span>
                    </div>
                    
                    <div class="order-actions">
                        <button class="btn-edit" data-order-number="${order.order_number}">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                        <button class="btn-delete" data-order-number="${order.order_number}">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                    </div>
                `;

                activeOrdersList.appendChild(li);

                // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞
                li.querySelector('.status-select').addEventListener('change', function() {
                    const orderNumber = this.getAttribute('data-order-number');
                    const newStatus = this.value;
                    changeOrderStatus(orderNumber, newStatus);
                });

                // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                li.querySelector('.btn-edit').addEventListener('click', function() {
                    const orderNumber = this.getAttribute('data-order-number');
                    const order = currentActiveOrders.find(o => o.order_number === orderNumber);
                    if (order) {
                        openEditModal(order);
                    }
                });

                // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è
                li.querySelector('.btn-delete').addEventListener('click', function() {
                    const orderNumber = this.getAttribute('data-order-number');
                    if (confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∑–∞–∫–∞–∑ ‚Ññ${orderNumber}?`)) {
                        deleteOrder(orderNumber);
                    }
                });
            });
        }

        /**
         * –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
         */
        function renderCompletedOrders() {
            completedOrdersList.innerHTML = '';

            if (currentCompletedOrders.length === 0) {
                completedOrdersList.innerHTML = '<li class="empty-message">–ù–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤</li>';
                return;
            }

            currentCompletedOrders.forEach((order) => {
                const li = document.createElement('li');
                li.className = 'completed-order-item';
                
                li.innerHTML = `
                    <div class="order-header">
                        <div class="order-number">‚Ññ${order.order_number} (–í—ã–¥–∞–Ω)</div>
                        <div class="order-hours" style="background: #9E9E9E;">‚úì</div>
                    </div>
                    <div class="customer-name">üë§ ${order.client_display}</div>
                    <div class="description">üìù ${order.description}</div>
                    
                    <div class="order-details">
                        <div class="detail-item">
                            <span class="detail-label">üìÖ –ë—ã–ª –≥–æ—Ç–æ–≤:</span>
                            <span>${order.ready_datetime}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">üïê –î–æ–±–∞–≤–ª–µ–Ω:</span>
                            <span>${order.created_at}</span>
                        </div>
                    </div>
                `;

                completedOrdersList.appendChild(li);
            });
        }

        /**
         * –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞
         * @param {Object} order - –æ–±—ä–µ–∫—Ç –∑–∞–∫–∞–∑–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
         */
        function openEditModal(order) {
            editingOrderNumber = order.order_number;
            
            editCustomerNameInput.value = order.client_display;
            editDescriptionInput.value = order.description;
            
            const [dateStr, timeStr] = order.ready_datetime.split(' ');
            const [day, month, year] = dateStr.split('.');
            const [hour, minute] = timeStr.split(':');
            
            editReadyDatetimeInput.value = `${year}-${month}-${day}T${hour}:${minute}`;
            
            editModal.classList.add('show');
        }

        /**
         * –ó–∞–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
         */
        function closeEditModal() {
            editModal.classList.remove('show');
            editingOrderNumber = null;
            editCustomerNameInput.value = '';
            editDescriptionInput.value = '';
            editReadyDatetimeInput.value = '';
        }

        // ===== –§–£–ù–ö–¶–ò–ò –î–õ–Ø –û–¢–ü–†–ê–í–ö–ò –°–û–û–ë–©–ï–ù–ò–ô –ù–ê –°–ï–†–í–ï–† =====

        /**
         * –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞
         * @param {string} orderNumber - –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞
         * @param {string} newStatus - –Ω–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å
         */
        function changeOrderStatus(orderNumber, newStatus) {
            if (socket.readyState !== WebSocket.OPEN) {
                alert('‚ùå –ù–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º.');
                return;
            }

            socket.send(JSON.stringify({
                action: 'change_status',
                order_number: parseInt(orderNumber),
                status: newStatus
            }));
        }

        /**
         * –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
         * @param {string} orderNumber - –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
         */
        function deleteOrder(orderNumber) {
            if (socket.readyState !== WebSocket.OPEN) {
                alert('‚ùå –ù–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º.');
                return;
            }

            socket.send(JSON.stringify({
                action: 'delete_order',
                order_number: parseInt(orderNumber)
            }));
        }

        // ===== –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô =====

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—ã–±–æ—Ä–∞ –∫–ª–∏–µ–Ω—Ç–∞
        clientSelect.addEventListener('change', toggleManualClientInput);

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞
        addClientBtn.addEventListener('click', openAddClientModal);

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞
        saveClientBtn.addEventListener('click', saveNewClient);

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –æ—Ç–º–µ–Ω—ã –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞
        cancelClientBtn.addEventListener('click', closeAddClientModal);

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–î–æ–±–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑"
        submitBtn.addEventListener('click', function() {
            const client = getSelectedClient();
            const description = descriptionInput.value.trim();
            const readyDatetime = readyDatetimeInput.value;
            
            if (!client) {
                alert('‚ö†Ô∏è –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –∏–ª–∏ –≤–≤–µ–¥–∏—Ç–µ –∫–ª–∏–µ–Ω—Ç–∞!');
                return;
            }
            
            if (!description || !readyDatetime) {
                alert('‚ö†Ô∏è –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏ –¥–∞—Ç—É –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏!');
                return;
            }
            
            if (socket.readyState !== WebSocket.OPEN) {
                alert('‚ùå –ù–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.');
                return;
            }
            
            // –ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –≤—ã–±—Ä–∞–Ω –∏–∑ –±–∞–∑—ã
            if (client.id) {
                socket.send(JSON.stringify({
                    action: 'add_order',
                    client_id: parseInt(client.id),
                    description: description,
                    ready_datetime: readyDatetime
                }));
            } else {
                // –ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –≤–≤–µ–¥–µ–Ω –≤—Ä—É—á–Ω—É—é
                socket.send(JSON.stringify({
                    action: 'add_order',
                    customer_name: client.name,
                    description: description,
                    ready_datetime: readyDatetime
                }));
            }
            
            clearForm();
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–û—á–∏—Å—Ç–∏—Ç—å"
        clearBtn.addEventListener('click', function() {
            clearForm();
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        saveEditBtn.addEventListener('click', function() {
            const customerName = editCustomerNameInput.value.trim();
            const description = editDescriptionInput.value.trim();
            const readyDatetime = editReadyDatetimeInput.value;

            if (!customerName || !description || !readyDatetime) {
                alert('‚ö†Ô∏è –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!');
                return;
            }

            if (socket.readyState !== WebSocket.OPEN) {
                alert('‚ùå –ù–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º.');
                return;
            }

            socket.send(JSON.stringify({
                action: 'update_order',
                order_number: editingOrderNumber,
                customer_name: customerName,
                description: description,
                ready_datetime: readyDatetime
            }));

            closeEditModal();
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–û—Ç–º–µ–Ω–∏—Ç—å" –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        cancelEditBtn.addEventListener('click', closeEditModal);

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ —Ñ–æ–Ω—É –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        editModal.addEventListener('click', function(e) {
            if (e.target === editModal) {
                closeEditModal();
            }
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ —Ñ–æ–Ω—É –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞
        addClientModal.addEventListener('click', function(e) {
            if (e.target === addClientModal) {
                closeAddClientModal();
            }
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
        document.getElementById('sort-by-number').addEventListener('click', function() {
            const btnNumber = document.getElementById('sort-by-number');
            const btnDeadline = document.getElementById('sort-by-deadline');
            
            if (sortBy === 'number') {
                sortDirection *= -1;
            } else {
                sortBy = 'number';
                sortDirection = 1;
                btnDeadline.classList.remove('active');
                btnNumber.classList.add('active');
            }
            
            renderActiveOrders();
        });

        document.getElementById('sort-by-deadline').addEventListener('click', function() {
            const btnNumber = document.getElementById('sort-by-number');
            const btnDeadline = document.getElementById('sort-by-deadline');
            
            if (sortBy === 'deadline') {
                sortDirection *= -1;
            } else {
                sortBy = 'deadline';
                sortDirection = 1;
                btnNumber.classList.remove('active');
                btnDeadline.classList.add('active');
            }
            
            renderActiveOrders();
        });

        // ===== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò =====

        /**
         * –û—á–∏—â–∞–µ—Ç —Ñ–æ—Ä–º—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
         */
        function clearForm() {
            clientSelect.value = '';
            customerNameInput.value = '';
            descriptionInput.value = '';
            readyDatetimeInput.value = '';
            setDefaultDateTime();
            toggleManualClientInput();
        }

        /**
         * –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å (–ø–Ω-–ø—Ç)
         * @returns {Date} –¥–∞—Ç–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è –≤ 15:00
         */
        function getNextBusinessDay() {
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            
            while (tomorrow.getDay() === 0 || tomorrow.getDay() === 6) {
                tomorrow.setDate(tomorrow.getDate() + 1);
            }
            
            tomorrow.setHours(15, 0, 0, 0);
            
            return tomorrow;
        }

        /**
         * –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –¥–∞—Ç—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ –ø–æ–ª–µ "–î–∞—Ç–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏"
         */
        function setDefaultDateTime() {
            const nextBusinessDay = getNextBusinessDay();
            
            const year = nextBusinessDay.getFullYear();
            const month = String(nextBusinessDay.getMonth() + 1).padStart(2, '0');
            const day = String(nextBusinessDay.getDate()).padStart(2, '0');
            const hours = String(nextBusinessDay.getHours()).padStart(2, '0');
            const minutes = String(nextBusinessDay.getMinutes()).padStart(2, '0');
            
            readyDatetimeInput.value = `${year}-${month}-${day}T${hours}:${minutes}`;
        }

        /**
         * –ó–∞–ø—É—Å–∫–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞–∫–∞–∑–æ–≤
         */
        function startAutoRefresh() {
            setInterval(() => {
                if (socket.readyState === WebSocket.OPEN) {
                    socket.send(JSON.stringify({
                        action: 'refresh_orders'
                    }));
                }
            }, 60000);
        }

        // ===== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø =====

        connect();
        setDefaultDateTime();
        startAutoRefresh();
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                if (socket.readyState === WebSocket.OPEN) {
                    // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (–≤–∫–ª—é—á–∞—è –∫–ª–∏–µ–Ω—Ç–æ–≤)
                    socket.send(JSON.stringify({
                        action: 'refresh_orders'
                    }));
                }
            }, 1000);
        });
    </script>
</body>
</html>