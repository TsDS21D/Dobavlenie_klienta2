<!--
index.html –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è print_price
–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ —Ü–µ–Ω –Ω–∞ –ø–µ—á–∞—Ç—å (—Ü–µ–Ω–∞ –∑–∞ 1 –ª–∏—Å—Ç)
-->

{% extends "print_price/base.html" %}

<!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
{% block title %}–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ü–µ–Ω –Ω–∞ –ø–µ—á–∞—Ç—å{% endblock %}

<!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
{% block content %}
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –ª–æ–≥–æ—Ç–∏–ø–æ–º -->
    <h1>
        <img src="https://www.bukva-a.ru/uploads/logo/logo300.png" 
            alt="–¢–∏–ø–æ–≥—Ä–∞—Ñ–∏—è &quot;–ë—É–∫–≤–∞ –ê&quot;" 
            title="–¢–∏–ø–æ–≥—Ä–∞—Ñ–∏—è &quot;–ë—É–∫–≤–∞ –ê&quot;"
            width="150">
        –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ü–µ–Ω –Ω–∞ –ø–µ—á–∞—Ç—å
    </h1>
    
    <!-- –°–∫—Ä—ã—Ç—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π Django -->
    <div class="django-messages" style="display: none;">
        {% if messages %}
            {% for message in messages %}
                <div class="django-message" data-type="{{ message.tags }}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}
    </div>
    
    <!-- –î–≤—É—Ö–∫–æ–ª–æ–Ω–æ—á–Ω—ã–π layout (–∫–∞–∫ –≤ sklad) -->
    <div class="two-column-layout">
        
        <!-- –õ–ï–í–ê–Ø –ö–û–õ–û–ù–ö–ê: –°–ø–∏—Å–æ–∫ –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤ -->
        <div class="left-column">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–µ–∫—Ü–∏–∏ –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤ -->
            <div class="section-header">
                <h2>
                    <i class="fas fa-print"></i> –ü—Ä–∏–Ω—Ç–µ—Ä—ã
                </h2>
            </div>
            
            <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–ø–∏—Å–∫–∞ –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤ -->
            <div class="printers-container" id="printers-container">
                <!-- –°–ø–∏—Å–æ–∫ –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤ -->
                <div class="printers-list">
                    {% for printer in printers %}
                        <!-- –≠–ª–µ–º–µ–Ω—Ç –ø—Ä–∏–Ω—Ç–µ—Ä–∞ -->
                        <a href="?printer_id={{ printer.id }}" 
                           class="printer-item {% if selected_printer and selected_printer.id == printer.id %}selected{% endif %}">
                            <div class="printer-info">
                                <div class="printer-name">
                                    <i class="fas fa-print"></i>
                                    {{ printer.name }}
                                </div>
                                <div class="printer-details">
                                    <span class="printer-format">
                                        <i class="fas fa-ruler"></i>
                                        {{ printer.sheet_format.name }}
                                    </span>
                                </div>
                            </div>
                            <div class="printer-stats">
                                <span class="price-count">
                                    {{ printer.print_prices.count }} —Ü–µ–Ω
                                </span>
                            </div>
                        </a>
                    {% empty %}
                        <!-- –ï—Å–ª–∏ –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤ –Ω–µ—Ç -->
                        <div class="empty-message">
                            <i class="fas fa-print"></i>
                            –ü—Ä–∏–Ω—Ç–µ—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–∏–Ω—Ç–µ—Ä—ã –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞".
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        
        <!-- –ü–†–ê–í–ê–Ø –ö–û–õ–û–ù–ö–ê: –¶–µ–Ω—ã –Ω–∞ –ø–µ—á–∞—Ç—å -->
        <div class="right-column">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–µ–∫—Ü–∏–∏ —Ü–µ–Ω -->
            <div class="section-header">
                <h2>
                    <i class="fas fa-money-bill-wave"></i> –¶–µ–Ω—ã –Ω–∞ –ø–µ—á–∞—Ç—å
                    {% if selected_printer %}
                    <span class="selected-printer">
                        –¥–ª—è –ø—Ä–∏–Ω—Ç–µ—Ä–∞ "<strong>{{ selected_printer.name }}</strong>"
                    </span>
                    {% endif %}
                </h2>
                <div class="header-buttons">
                    <!-- –ö–Ω–æ–ø–∫–∞ —Å–±—Ä–æ—Å–∞ –≤—ã–±–æ—Ä–∞ –ø—Ä–∏–Ω—Ç–µ—Ä–∞ -->
                    {% if selected_printer %}
                    <a href="/print_price/" 
                       class="btn-action btn-reset-filter"
                       title="–°–±—Ä–æ—Å–∏—Ç—å –≤—ã–±–æ—Ä –ø—Ä–∏–Ω—Ç–µ—Ä–∞">
                        <i class="fas fa-times-circle"></i> –°–±—Ä–æ—Å–∏—Ç—å
                    </a>
                    {% endif %}
                    <!-- –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ü–µ–Ω—ã -->
                    <button type="button" 
                            class="btn-action btn-add-price" 
                            id="add-price-btn">
                        + –î–æ–±–∞–≤–∏—Ç—å —Ü–µ–Ω—É
                    </button>
                </div>
            </div>
            
            <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ü–µ–Ω—ã (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç–∞) -->
            <div class="form-section" id="price-form-section" style="display: none;">
                <h3>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Ü–µ–Ω—É</h3>
                
                <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ü–µ–Ω—ã -->
                <form method="post" action="{% url 'print_price:create_print_price' %}" id="price-form">
                    {% csrf_token %}
                    
                    <!-- –ü—Ä–∏–Ω—Ç–µ—Ä (—Å–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ –∏–ª–∏ –≤—ã–±–æ—Ä) -->
                    <div class="form-group">
                        <label for="price-printer">–ü—Ä–∏–Ω—Ç–µ—Ä*</label>
                        <select id="price-printer" 
                                name="printer" 
                                class="form-control" 
                                required>
                            <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–Ω—Ç–µ—Ä --</option>
                            {% for printer in printers %}
                                <option value="{{ printer.id }}" 
                                        {% if selected_printer and selected_printer.id == printer.id %}selected{% endif %}>
                                    {{ printer.name }}
                                </option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <!-- –¢–∏—Ä–∞–∂ –∏ —Ü–µ–Ω–∞ –∑–∞ –ª–∏—Å—Ç –≤ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="price-copies">–¢–∏—Ä–∞–∂ (—à—Ç.)*</label>
                            <input type="number" 
                                   id="price-copies" 
                                   name="copies" 
                                   class="form-control"
                                   min="1" 
                                   placeholder="100"
                                   required>
                        </div>
                        
                        <div class="form-group">
                            <label for="price-per-sheet">–¶–µ–Ω–∞ –∑–∞ 1 –ª–∏—Å—Ç (—Ä—É–±.)*</label>
                            <input type="number" 
                                   id="price-per-sheet" 
                                   name="price_per_sheet" 
                                   class="form-control"
                                   step="0.01" 
                                   min="0.01" 
                                   placeholder="2.50"
                                   required>
                        </div>
                    </div>
                    
                    <!-- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –æ–±—â–µ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏ -->
                    <div class="total-price-preview" id="total-price-preview" style="display: none;">
                        <div class="total-price-label">
                            <i class="fas fa-calculator"></i>
                            –û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞ —Ç–∏—Ä–∞–∂:
                        </div>
                        <div class="total-price-value" id="total-price-value">
                            <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å -->
                        </div>
                    </div>
                    
                    <!-- –ö–Ω–æ–ø–∫–∏ —Ñ–æ—Ä–º—ã -->
                    <div class="button-group">
                        <button type="submit" class="btn-submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ü–µ–Ω—É</button>
                        <button type="button" class="btn-clear" onclick="clearPriceForm()">–û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É</button>
                    </div>
                </form>
            </div>
            
            <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Ü–µ–Ω —Å –ø—Ä–æ–∫—Ä—É—Ç–∫–æ–π -->
            <div class="prices-container">
                <div class="prices-section">
                    {% if not selected_printer %}
                        <!-- –°–æ–æ–±—â–µ–Ω–∏–µ, –µ—Å–ª–∏ –ø—Ä–∏–Ω—Ç–µ—Ä –Ω–µ –≤—ã–±—Ä–∞–Ω -->
                        <div class="empty-message">
                            <i class="fas fa-hand-pointer"></i>
                            –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–Ω—Ç–µ—Ä —Å–ª–µ–≤–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ü–µ–Ω –Ω–∞ –ø–µ—á–∞—Ç—å.
                        </div>
                    {% elif not print_prices %}
                        <!-- –°–æ–æ–±—â–µ–Ω–∏–µ, –µ—Å–ª–∏ —Ü–µ–Ω –Ω–µ—Ç -->
                        <div class="empty-message">
                            <i class="fas fa-money-bill-wave"></i>
                            –î–ª—è –ø—Ä–∏–Ω—Ç–µ—Ä–∞ "{{ selected_printer.name }}" –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ü–µ–Ω.
                            <br>
                            <small>–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é —Ü–µ–Ω—É, –∏—Å–ø–æ–ª—å–∑—É—è –∫–Ω–æ–ø–∫—É "–î–æ–±–∞–≤–∏—Ç—å —Ü–µ–Ω—É".</small>
                        </div>
                    {% else %}
                        <!-- –¢–∞–±–ª–∏—Ü–∞ —Å–æ —Å–ø–∏—Å–∫–æ–º —Ü–µ–Ω -->
                        <div class="prices-table">
                            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã -->
                            <div class="table-header">
                                <div class="col-copies">–¢–∏—Ä–∞–∂</div>
                                <div class="col-price-per-sheet">–¶–µ–Ω–∞ –∑–∞ –ª–∏—Å—Ç</div>
                                <div class="col-total-price">–°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞ —Ç–∏—Ä–∞–∂</div>
                                <div class="col-actions">–î–µ–π—Å—Ç–≤–∏—è</div>
                            </div>
                            
                            <!-- –¢–µ–ª–æ —Ç–∞–±–ª–∏—Ü—ã —Å –ø—Ä–æ–∫—Ä—É—Ç–∫–æ–π -->
                            <div class="table-body">
                                <!-- –¶–∏–∫–ª –ø–æ –≤—Å–µ–º —Ü–µ–Ω–∞–º -->
                                {% for price in print_prices %}
                                    <!-- –û–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ —Ç–∞–±–ª–∏—Ü—ã -->
                                    <div class="table-row" data-price-id="{{ price.id }}">
                                        
                                        <!-- –ö–æ–ª–æ–Ω–∫–∞: –¢–∏—Ä–∞–∂ (—Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è) -->
                                        <div class="col-copies">
                                            <span class="copies-badge editable-field" 
                                                  data-field="copies" 
                                                  data-price-id="{{ price.id }}"
                                                  data-original-value="{{ price.copies|stringformat:'d' }}"
                                                  title="–î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è">
                                                {{ price.get_copies_display }}
                                            </span>
                                            <!-- –°–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ –≤–≤–æ–¥–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
                                            <input type="number" 
                                                   class="inline-edit-input copies-input" 
                                                   data-price-id="{{ price.id }}"
                                                   data-field="copies"
                                                   value="{{ price.copies|stringformat:'d' }}"
                                                   min="1"
                                                   step="1"
                                                   style="display: none;"
                                                   placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–∏—Ä–∞–∂">
                                        </div>
                                        
                                        <!-- –ö–æ–ª–æ–Ω–∫–∞: –¶–µ–Ω–∞ –∑–∞ 1 –ª–∏—Å—Ç (—Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è) -->
                                        <div class="col-price-per-sheet">
                                            <span class="price-per-sheet-badge editable-field" 
                                                  data-field="price_per_sheet" 
                                                  data-price-id="{{ price.id }}"
                                                  data-original-value="{{ price.price_per_sheet|stringformat:'f' }}"
                                                  title="–î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è">
                                                {{ price.get_price_per_sheet_display }}
                                            </span>
                                            <!-- –°–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ –≤–≤–æ–¥–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
                                            <input type="number" 
                                                   class="inline-edit-input price-per-sheet-input" 
                                                   data-price-id="{{ price.id }}"
                                                   data-field="price_per_sheet"
                                                   value="{{ price.price_per_sheet|stringformat:'f' }}"
                                                   min="0.01"
                                                   step="0.01"
                                                   style="display: none;"
                                                   placeholder="–í–≤–µ–¥–∏—Ç–µ —Ü–µ–Ω—É">
                                        </div>
                                        
                                        <!-- –ö–æ–ª–æ–Ω–∫–∞: –û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞ —Ç–∏—Ä–∞–∂ (—Ç–æ–ª—å–∫–æ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è) -->
                                        <div class="col-total-price">
                                            <span class="total-price-badge">
                                                {{ price.get_total_price_display }}
                                            </span>
                                        </div>
                                        
                                        <!-- –ö–æ–ª–æ–Ω–∫–∞: –î–µ–π—Å—Ç–≤–∏—è -->
                                        <div class="col-actions">
                                            <!-- –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è -->
                                            <button type="button" 
                                                    class="btn-action btn-delete"
                                                    data-price-id="{{ price.id }}"
                                                    data-price-copies="{{ price.copies }}">
                                                –£–¥–∞–ª–∏—Ç—å
                                            </button>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                        
                        <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
                        <div class="table-hint">
                            <div class="hint-item">
                                <span class="hint-icon">‚úèÔ∏è</span>
                                <span class="hint-text">–î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –ø–æ —Ç–∏—Ä–∞–∂—É –∏–ª–∏ —Ü–µ–Ω–µ –∑–∞ –ª–∏—Å—Ç –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</span>
                            </div>
                            <div class="hint-item">
                                <span class="hint-icon">üíæ</span>
                                <span class="hint-text">–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–ª–∏ Esc –¥–ª—è –æ—Ç–º–µ–Ω—ã —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</span>
                            </div>
                            <div class="hint-item">
                                <span class="hint-icon">üí∞</span>
                                <span class="hint-text">–°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞ —Ç–∏—Ä–∞–∂ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (—Ü–µ–Ω–∞ –∑–∞ –ª–∏—Å—Ç √ó —Ç–∏—Ä–∞–∂)</span>
                            </div>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
{% endblock %}