"""
views.py - контроллеры (обработчики запросов) для приложения product_templates.
Здесь определяются функции, которые обрабатывают HTTP-запросы и возвращают HTML-страницы.
"""

# Импортируем необходимые модули Django
from django.shortcuts import render  # Функция для рендеринга HTML-шаблонов
from django.views.decorators.cache import never_cache  # Декоратор для отключения кэширования
from django.contrib.auth.decorators import login_required  # Декоратор для ограничения доступа

# Декоратор @login_required проверяет, авторизован ли пользователь
# Если нет - перенаправляет на страницу входа (LOGIN_URL из settings.py)
# Декоратор @never_cache запрещает браузеру кэшировать страницу
@login_required(login_url='/counter/login/')
@never_cache
def index(request):
    """
    Главная страница приложения "Шаблоны изделий".
    
    Аргументы:
        request (HttpRequest): объект запроса от пользователя, содержащий
                              информацию о запросе, пользователе, сессии и т.д.
    
    Возвращает:
        HttpResponse: HTML-страница с отрендеренным шаблоном
    
    Примечание:
        - login_required: только авторизованные пользователи могут видеть страницу
        - never_cache: страница всегда будет загружаться с сервера (не из кэша)
    """
    
    # Подготавливаем контекст - данные, которые передадим в HTML-шаблон
    # В данном случае передаем только объект пользователя, но позже добавим и другие данные
    context = {
        'user': request.user,  # Текущий авторизованный пользователь
        'active_app': 'product_templates',  # Для подсветки активного приложения в навигации
        'page_title': 'Шаблоны изделий - Типография Буква А',  # Заголовок страницы
    }
    
    # Рендерим HTML-шаблон и возвращаем его пользователю
    # Первый аргумент - объект запроса
    # Второй аргумент - путь к шаблону относительно папки templates приложения
    # Третий аргумент - словарь с данными для шаблона
    return render(request, 'product_templates/index.html', context)